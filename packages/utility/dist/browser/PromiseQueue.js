(()=>{"use strict";var e={d:(t,r)=>{for(var n in r){e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e){return function(e){if(Array.isArray(e)){return o(e)}}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"]){return Array.from(e)}}(e)||function(e,t){if(!e){return}if("string"==typeof e){return o(e,t)}var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r){return Array.from(e)}if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)){return o(e,t)}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++){n[r]=e[r]}return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=r(e)||!e){return e}var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o)){return o}throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}e.r(t),e.d(t,{PromisePool:()=>j,PromiseQueue:()=>k,doPoll:()=>S,promisePool:()=>j,promiseQueue:()=>k});var a={},c=function(){return e=function e(){!function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}(this,e),a={}},t=[{key:"on",value:function(e,t){this.registerListener(e,t)}},{key:"once",value:function(e,t){this.registerListener(e,t,1)}},{key:"exactly",value:function(e,t,r){this.registerListener(e,t,r)}},{key:"off",value:function(e){delete a[e]}},{key:"detach",value:function(e,t){var r=(a[e]||[]).filter((function(e){return e.callback!==t}));return e in a&&(a[e]=r,!0)}},{key:"emit",value:function(e){for(var t=this,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++){o[i-1]=arguments[i]}var u=[],c=null,s=this.extractContextFromArgs(o),l=s[0];if(o=s[1],this.hasListener(e)){u=a[e]}else if(e.includes("*")){(c=this.patternSearch(e,Object.keys(a))).length>0&&c.forEach((function(e){u=u.concat(a[e])}))}else{for(var f in a){f.includes("*")&&(c=this.patternSearch(f,[e]))&&(u=u.concat(a[f]))}}u.forEach((function(r,i){var c=r.callback;l&&(c=c.bind(l)),void 0!==r.triggerCapacity&&(r.triggerCapacity--,u[i].triggerCapacity=r.triggerCapacity),t.checkToRemoveListener(r)&&a[e].splice(i,1),c.apply(void 0,n(o))}))}},{key:"patternSearch",value:function(e,t){var r,n=new RegExp(this.setWildCardString(e),"g");return 0===(r=t.filter((function(e){return n.test(e)}))).length?null:r}},{key:"setWildCardString",value:function(e){var t=e.replace(/([.+?^${}()|\[\]\/\\])/g,"\\$&");return t=t.replace(/\*/g,"(.*?)"),"^".concat(t)}},{key:"extractContextFromArgs",value:function(e){for(var t=null,n=0;n<e.length;n++){var o=e[n];if(o&&"object"===r(o)&&o.hasOwnProperty("__context")){t=o.__context,e.splice(n,1);break}}return[t,e]}},{key:"registerListener",value:function(e,t,r){this.hasListener(e)||(a[e]=[]),a[e].push({callback:t,triggerCapacity:r})}},{key:"checkToRemoveListener",value:function(e){return void 0!==e.triggerCapacity&&e.triggerCapacity<=0}},{key:"hasListener",value:function(e){return e in a}},{key:"global",value:function(){return s()}}],t&&i(e.prototype,t),o&&i(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o}();function s(){return"undefined"!=typeof window?(window.eventBus||(window.eventBus=new c),window.eventBus):"undefined"!=typeof global?(global.eventBus||(global.eventBus=new c),global.eventBus):new c}var l=function(e){return Array.isArray(e)?e:[e]};function f(){return"kn__"+(new Date).getTime()+"__"+Math.floor(899*Math.random())}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function m(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h(e){var t=function(e,t){if("object"!=y(e)||!e){return e}var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=y(n)){return n}throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}function d(e,t,r){return t=g(t),function(e,t){if(t&&("object"===y(t)||"function"==typeof t)){return t}if(void 0!==t){throw new TypeError("Derived constructors may only return object or undefined")}return function(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}(e)}(e,b()?Reflect.construct(t,r||[],g(e).constructor):t.apply(e,r))}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function w(e,t){if("function"!=typeof t&&null!==t){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}var j=function(){var e="in-progress",t={},r=[];return new(function(n){function o(){return p(this,o),d(this,o)}return w(o,n),m(o,[{key:"add",value:function(e){if(!(e instanceof Promise!=!0||!(Array.isArray(e)&&e.every((function(e){return e instanceof Promise}))))){throw new Error("promisePool: The first argument must be a promise or an array of promises.")}var r=this;l(e).forEach((function(e){var n=Promise.all([e]),o=f();t[o]={promiseBag:n,status:"in-progress"},n.then((function(){t[o].status="completed",r._updateStatus()})).catch((function(){t[o].status="rejected",r._updateStatus()}))}))}},{key:"status",value:function(){return e}},{key:"isDone",value:function(){return"done"===e}},{key:"_updateStatus",value:function(){if("done"!==e){var n=Object.values(t);n.forEach((function(e){"rejected"===e.status&&r.push(e)}));var o=n.every((function(e){return"completed"===e.status||"rejected"===e.status}));e=o?"done":"in-progress",this.emit("stats",{completed:n.filter((function(e){return"completed"===e.status})).length,rejected:r.length,pending:n.filter((function(e){return"in-progress"===e.status})).length,total:n.length}),"done"===e&&(this.emit("completed"),this.emit("rejected",r),this.clear())}}},{key:"clear",value:function(){t={},r=[]}}])}(c))},k=function(e){function t(){var e;return p(this,t),(e=d(this,t)).queue=[],e.inProgress=!1,e._timer=null,e}return w(t,e),m(t,[{key:"add",value:function(e){var t=this;l(e).forEach((function(e){t.queue.push({promiseFunction:e,status:"pending"})})),this.inProgress||this._next(),this._setTimer()}},{key:"clear",value:function(){this.queue=[]}},{key:"_setTimer",value:function(){var e=this;this._timer&&clearInterval(this._timer),this._timer=setInterval((function(){"done"===e.status()&&(e.emit("completed"),clearInterval(e._timer),e._timer=null)}),10)}},{key:"_next",value:function(){var e=this;0!==this.queue.length?(this.inProgress=!0,(0,this.queue[0].promiseFunction)().then((function(){e.queue[0].status="fulfilled"})).catch((function(){e.queue[0].status="rejected"})).finally((function(){e.queue.shift(),e._next()}))):this.inProgress=!1}},{key:"status",value:function(){return 0===this.queue.length?"done":"in-progress"}}])}(c),S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e){throw new Error("doPoll: The first argument must be a function.")}var r,n,o,i,u=t.interval,a=void 0===u?200:u,c=t.timeout,s=void 0===c?1e3:c,l=t.timeoutMsg,f=void 0===l?"===> doPoll: cancelled or timed out.":l,y=!1,p=function(){m(),i(console.info(f))},v=function(e){m(),o(e)};function m(){y=!0,clearTimeout(r),clearInterval(n)}return{promise:new Promise((function(t,u){o=t,i=u;var c=e instanceof Promise,l=function(){if(!y){var t=c?e:e();c?t.then((function(e){e&&v(e)})).catch(i):(Boolean(t)||t)&&v(t)}};n=setInterval(l,a),l(),r=setTimeout((function(){y||p()}),s)})),stop:p}};window.PromiseQueue=t})();